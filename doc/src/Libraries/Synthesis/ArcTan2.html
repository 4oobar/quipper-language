<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Haskell code</title>
</head>
<body>
<pre><a name="line-1"></a><font color=Blue><i>-- | This module provides a replacement for Haskell's 'atan2'. The</i></font>
<a name="line-2"></a><font color=Blue><i>-- problem is that Haskell's standard implementation of 'atan2'</i></font>
<a name="line-3"></a><font color=Blue><i>-- depends on the 'RealFloat' class, which limits its applicability.</i></font>
<a name="line-4"></a><font color=Blue><i>-- So we provide a new 'ArcTan2' class with an 'arctan2' function.</i></font>
<a name="line-5"></a><font color=Blue><i>-- </i></font>
<a name="line-6"></a><font color=Blue><i>-- Unlike Haskell's 'atan2', the 'arctan2' function may not take</i></font>
<a name="line-7"></a><font color=Blue><i>-- signed zeros and signed infinities into account. But it works at</i></font>
<a name="line-8"></a><font color=Blue><i>-- fixed-precision types such as 'FixedPrec'.</i></font>
<a name="line-9"></a>
<a name="line-10"></a><font color=Green><u>module</u></font> Libraries<font color=Cyan>.</font>Synthesis<font color=Cyan>.</font>ArcTan2 <font color=Green><u>where</u></font>
<a name="line-11"></a>
<a name="line-12"></a><font color=Green><u>import</u></font> Data<font color=Cyan>.</font>Number<font color=Cyan>.</font>FixedPrec
<a name="line-13"></a>
<a name="line-14"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-15"></a><font color=Blue><i>-- * The arctan2 function</i></font>
<a name="line-16"></a>
<a name="line-17"></a><a name="ArcTan2"></a><font color=Blue><i>-- | We provide a replacement for Haskell's 'atan2', because the</i></font>
<a name="line-18"></a><a name="ArcTan2"></a><font color=Blue><i>-- latter depends on the 'RealFloat' class, which limits its</i></font>
<a name="line-19"></a><a name="ArcTan2"></a><font color=Blue><i>-- applicability.</i></font>
<a name="line-20"></a><a name="ArcTan2"></a><font color=Green><u>class</u></font> ArcTan2 a <font color=Green><u>where</u></font>
<a name="line-21"></a>  arctan2 <font color=Red>::</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> a
<a name="line-22"></a>  
<a name="line-23"></a><font color=Green><u>instance</u></font> ArcTan2 Double <font color=Green><u>where</u></font>
<a name="line-24"></a>  arctan2 <font color=Red>=</font> atan2
<a name="line-25"></a>
<a name="line-26"></a><font color=Green><u>instance</u></font> ArcTan2 Float <font color=Green><u>where</u></font>
<a name="line-27"></a>  arctan2 <font color=Red>=</font> atan2
<a name="line-28"></a>
<a name="line-29"></a><font color=Green><u>instance</u></font> <font color=Cyan>(</font>Precision e<font color=Cyan>)</font> <font color=Red>=&gt;</font> ArcTan2 <font color=Cyan>(</font>FixedPrec e<font color=Cyan>)</font> <font color=Green><u>where</u></font>
<a name="line-30"></a>  arctan2 y x
<a name="line-31"></a>    <font color=Red>|</font> x <font color=Cyan>==</font> <font color=Magenta>0</font> <font color=Cyan>&amp;&amp;</font> y <font color=Cyan>==</font> <font color=Magenta>0</font> <font color=Red>=</font> <font color=Magenta>0</font>
<a name="line-32"></a>    <font color=Red>|</font> abs y <font color=Cyan>&lt;=</font> x       <font color=Red>=</font> atan <font color=Cyan>(</font>y<font color=Cyan>/</font>x<font color=Cyan>)</font>
<a name="line-33"></a>    <font color=Red>|</font> abs x <font color=Cyan>&lt;=</font> y       <font color=Red>=</font> pi<font color=Cyan>/</font><font color=Magenta>2</font> <font color=Blue><i>-</i></font> atan <font color=Cyan>(</font>x<font color=Cyan>/</font>y<font color=Cyan>)</font>
<a name="line-34"></a>    <font color=Red>|</font> abs x <font color=Cyan>&lt;=</font> <font color=Blue><i>-</i></font>y      <font color=Red>=</font> <font color=Blue><i>-</i></font>pi<font color=Cyan>/</font><font color=Magenta>2</font> <font color=Blue><i>-</i></font> atan <font color=Cyan>(</font>x<font color=Cyan>/</font>y<font color=Cyan>)</font>
<a name="line-35"></a>    <font color=Red>|</font> y <font color=Cyan>&gt;=</font> <font color=Magenta>0</font>           <font color=Red>=</font> pi <font color=Cyan>+</font> atan <font color=Cyan>(</font>y<font color=Cyan>/</font>x<font color=Cyan>)</font>
<a name="line-36"></a>    <font color=Red>|</font> otherwise        <font color=Red>=</font> <font color=Blue><i>-</i></font>pi <font color=Cyan>+</font> atan <font color=Cyan>(</font>y<font color=Cyan>/</font>x<font color=Cyan>)</font>
</pre>
</body>
</html>