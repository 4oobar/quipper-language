<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Haskell code</title>
</head>
<body>
<pre><a name="line-1"></a><font color=Blue><i>{-# LANGUAGE FlexibleInstances #-}</i></font>
<a name="line-2"></a>
<a name="line-3"></a><font color=Blue><i>-- | This module provides a type class for Euclidean domains. A</i></font>
<a name="line-4"></a><font color=Blue><i>-- Euclidean domain is a ring with a notion of division with</i></font>
<a name="line-5"></a><font color=Blue><i>-- remainder, and therefore greatest common divisors.</i></font>
<a name="line-6"></a>
<a name="line-7"></a><font color=Green><u>module</u></font> Libraries<font color=Cyan>.</font>Synthesis<font color=Cyan>.</font>EuclideanDomain <font color=Green><u>where</u></font>
<a name="line-8"></a>
<a name="line-9"></a><font color=Green><u>import</u></font> Libraries<font color=Cyan>.</font>Synthesis<font color=Cyan>.</font>Ring
<a name="line-10"></a><font color=Green><u>import</u></font> Data<font color=Cyan>.</font>Maybe
<a name="line-11"></a>
<a name="line-12"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-13"></a><font color=Blue><i>-- * Euclidean domains</i></font>
<a name="line-14"></a>
<a name="line-15"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-16"></a><font color=Blue><i>-- ** Definition</i></font>
<a name="line-17"></a>
<a name="line-18"></a><a name="EuclideanDomain"></a><font color=Blue><i>-- | A type class for Euclidean domains. A Euclidean domain is a ring</i></font>
<a name="line-19"></a><a name="EuclideanDomain"></a><font color=Blue><i>-- with a Euclidean function and a division with remainder.</i></font>
<a name="line-20"></a><a name="EuclideanDomain"></a><font color=Green><u>class</u></font> <font color=Cyan>(</font>Eq a<font color=Cyan>,</font> Ring a<font color=Cyan>)</font> <font color=Red>=&gt;</font> EuclideanDomain a <font color=Green><u>where</u></font>
<a name="line-21"></a>  <font color=Blue><i>-- | The Euclidean function for the Euclidean domain. This is a</i></font>
<a name="line-22"></a>  <font color=Blue><i>-- function /rank/ : /R/\\{0} &#8594; &#8469; such that:</i></font>
<a name="line-23"></a>  <font color=Blue><i>-- </i></font>
<a name="line-24"></a>  <font color=Blue><i>-- * for all nonzero /a/, /b/ &#8712; /R/, /rank/(/a/) &#8804; /rank/(/ab/);</i></font>
<a name="line-25"></a>  <font color=Blue><i>-- </i></font>
<a name="line-26"></a>  <font color=Blue><i>-- * if /b/ &#8800; 0 and (/q/,/r/) = /a/ `divmod` /b/, then either /r/ =</i></font>
<a name="line-27"></a>  <font color=Blue><i>-- 0 or /rank/(/r/) &lt; /rank/(/b/).</i></font>
<a name="line-28"></a>  rank <font color=Red>::</font> a <font color=Red>-&gt;</font> Integer
<a name="line-29"></a>  <font color=Blue><i>-- | Given /a/ and /b/&#8800;0, return a quotient and remainder for</i></font>
<a name="line-30"></a>  <font color=Blue><i>-- division of /a/ by /b/. Specifically, return (/q/,/r/) such that</i></font>
<a name="line-31"></a>  <font color=Blue><i>-- /a/ = /qb/ + /r/, and such that /r/ = 0 or /rank/(/r/) &lt; /rank/(/b/).</i></font>
<a name="line-32"></a>  divmod <font color=Red>::</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> <font color=Cyan>(</font>a<font color=Cyan>,</font>a<font color=Cyan>)</font>
<a name="line-33"></a>
<a name="line-34"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-35"></a><font color=Blue><i>-- Particular Euclidean domains</i></font>
<a name="line-36"></a>
<a name="line-37"></a><font color=Green><u>instance</u></font> EuclideanDomain Integer <font color=Green><u>where</u></font>
<a name="line-38"></a>  rank x <font color=Red>=</font> x
<a name="line-39"></a>  divmod x y <font color=Red>=</font> divMod x y
<a name="line-40"></a>
<a name="line-41"></a><font color=Green><u>instance</u></font> EuclideanDomain ZComplex <font color=Green><u>where</u></font>
<a name="line-42"></a>  rank x <font color=Red>=</font> abs <font color=Cyan>(</font>norm x<font color=Cyan>)</font>
<a name="line-43"></a>  divmod x y <font color=Red>=</font> <font color=Cyan>(</font>q<font color=Cyan>,</font> r<font color=Cyan>)</font> <font color=Green><u>where</u></font>
<a name="line-44"></a>    <font color=Cyan>(</font>Cplx l m<font color=Cyan>)</font> <font color=Red>=</font> x <font color=Cyan>*</font> adj y
<a name="line-45"></a>    k <font color=Red>=</font> norm y
<a name="line-46"></a>    q1 <font color=Red>=</font> l <font color=Cyan>`rounddiv`</font> k
<a name="line-47"></a>    q2 <font color=Red>=</font> m <font color=Cyan>`rounddiv`</font> k
<a name="line-48"></a>    q <font color=Red>=</font> Cplx q1 q2
<a name="line-49"></a>    r <font color=Red>=</font> x <font color=Blue><i>-</i></font> y <font color=Cyan>*</font> q
<a name="line-50"></a>
<a name="line-51"></a><font color=Green><u>instance</u></font> EuclideanDomain DInteger <font color=Green><u>where</u></font>
<a name="line-52"></a>  rank x <font color=Red>=</font> abs <font color=Cyan>(</font>norm x<font color=Cyan>)</font>
<a name="line-53"></a>  divmod x y<font color=Red>@</font><font color=Cyan>(</font>RootTwo c d<font color=Cyan>)</font> <font color=Red>=</font> <font color=Cyan>(</font>q<font color=Cyan>,</font> r<font color=Cyan>)</font> <font color=Green><u>where</u></font>
<a name="line-54"></a>    <font color=Cyan>(</font>RootTwo l m<font color=Cyan>)</font> <font color=Red>=</font> x <font color=Cyan>*</font> adj2 y
<a name="line-55"></a>    k <font color=Red>=</font> norm y
<a name="line-56"></a>    q1 <font color=Red>=</font> l <font color=Cyan>`rounddiv`</font> k
<a name="line-57"></a>    q2 <font color=Red>=</font> m <font color=Cyan>`rounddiv`</font> k
<a name="line-58"></a>    q <font color=Red>=</font> RootTwo q1 q2
<a name="line-59"></a>    r <font color=Red>=</font> x <font color=Blue><i>-</i></font> y <font color=Cyan>*</font> q
<a name="line-60"></a>  
<a name="line-61"></a><font color=Green><u>instance</u></font> EuclideanDomain ZOmega <font color=Green><u>where</u></font>
<a name="line-62"></a>  rank x <font color=Red>=</font> abs <font color=Cyan>(</font>norm x<font color=Cyan>)</font>
<a name="line-63"></a>  divmod x y <font color=Red>=</font> <font color=Cyan>(</font>q<font color=Cyan>,</font> r<font color=Cyan>)</font> <font color=Green><u>where</u></font>
<a name="line-64"></a>    <font color=Cyan>(</font>Omega a' b' c' d'<font color=Cyan>)</font> <font color=Red>=</font> x <font color=Cyan>*</font> adj y <font color=Cyan>*</font> adj2<font color=Cyan>(</font>y <font color=Cyan>*</font> adj y<font color=Cyan>)</font>
<a name="line-65"></a>    k <font color=Red>=</font> norm y
<a name="line-66"></a>    a <font color=Red>=</font> a' <font color=Cyan>`rounddiv`</font> k
<a name="line-67"></a>    b <font color=Red>=</font> b' <font color=Cyan>`rounddiv`</font> k
<a name="line-68"></a>    c <font color=Red>=</font> c' <font color=Cyan>`rounddiv`</font> k
<a name="line-69"></a>    d <font color=Red>=</font> d' <font color=Cyan>`rounddiv`</font> k
<a name="line-70"></a>    q <font color=Red>=</font> Omega a b c d
<a name="line-71"></a>    r <font color=Red>=</font> x <font color=Blue><i>-</i></font> y <font color=Cyan>*</font> q    
<a name="line-72"></a>
<a name="line-73"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-74"></a><font color=Blue><i>-- ** Functions</i></font>
<a name="line-75"></a>
<a name="line-76"></a><a name="euclid_mod"></a><font color=Blue><i>-- | Calculate the remainder for the division of /x/ by /y/.</i></font>
<a name="line-77"></a><font color=Blue>euclid_mod</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> a
<a name="line-78"></a><font color=Blue>euclid_mod</font> x y <font color=Red>=</font> r <font color=Green><u>where</u></font>
<a name="line-79"></a>  <font color=Cyan>(</font>q<font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> x <font color=Cyan>`divmod`</font> y
<a name="line-80"></a>
<a name="line-81"></a><font color=Green><u>infixl</u></font> <font color=Magenta>7</font> <font color=Cyan>`euclid_mod`</font>
<a name="line-82"></a>
<a name="line-83"></a><a name="euclid_div"></a><font color=Blue><i>-- | Calculate the quotient for the division of /x/ by /y/, ignoring</i></font>
<a name="line-84"></a><font color=Blue><i>-- the remainder, if any. This is typically, but not always, used in</i></font>
<a name="line-85"></a><font color=Blue><i>-- situations where the remainder is known to be 0 ahead of time.</i></font>
<a name="line-86"></a><font color=Blue>euclid_div</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> a
<a name="line-87"></a><font color=Blue>euclid_div</font> x y <font color=Red>=</font> q <font color=Green><u>where</u></font>
<a name="line-88"></a>  <font color=Cyan>(</font>q<font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> x <font color=Cyan>`divmod`</font> y
<a name="line-89"></a>
<a name="line-90"></a><font color=Green><u>infixl</u></font> <font color=Magenta>7</font> <font color=Cyan>`euclid_div`</font>
<a name="line-91"></a>
<a name="line-92"></a><a name="euclid_gcd"></a><font color=Blue><i>-- | Calculate the greatest common divisor in any Euclidean domain.</i></font>
<a name="line-93"></a><font color=Blue>euclid_gcd</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> a
<a name="line-94"></a><font color=Blue>euclid_gcd</font> x y
<a name="line-95"></a>  <font color=Red>|</font> y <font color=Cyan>==</font> <font color=Magenta>0</font> <font color=Red>=</font> x
<a name="line-96"></a>  <font color=Red>|</font> otherwise <font color=Red>=</font> euclid_gcd y r <font color=Green><u>where</u></font>
<a name="line-97"></a>    <font color=Cyan>(</font><font color=Green><u>_</u></font><font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> divmod x y
<a name="line-98"></a>
<a name="line-99"></a><a name="extended_euclid"></a><font color=Blue><i>-- | Perform the extended Euclidean algorithm. On inputs /x/ and</i></font>
<a name="line-100"></a><font color=Blue><i>-- /y/, this returns (/a/,/b/,/s/,/t/,/d/) such that:</i></font>
<a name="line-101"></a><font color=Blue><i>-- </i></font>
<a name="line-102"></a><font color=Blue><i>-- * /d/ = gcd(/x/,/y/),</i></font>
<a name="line-103"></a><font color=Blue><i>-- </i></font>
<a name="line-104"></a><font color=Blue><i>-- * /ax/ + /by/ = /d/,</i></font>
<a name="line-105"></a><font color=Blue><i>-- </i></font>
<a name="line-106"></a><font color=Blue><i>-- * /sx/ + /ty/ = 0,</i></font>
<a name="line-107"></a><font color=Blue><i>-- </i></font>
<a name="line-108"></a><font color=Blue><i>-- * /at/ - /bs/ = 1.</i></font>
<a name="line-109"></a><font color=Blue>extended_euclid</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> <font color=Cyan>(</font>a<font color=Cyan>,</font> a<font color=Cyan>,</font> a<font color=Cyan>,</font> a<font color=Cyan>,</font> a<font color=Cyan>)</font>
<a name="line-110"></a><font color=Blue>extended_euclid</font> x y
<a name="line-111"></a>  <font color=Red>|</font> y <font color=Cyan>==</font> <font color=Magenta>0</font> <font color=Red>=</font> <font color=Cyan>(</font><font color=Magenta>1</font><font color=Cyan>,</font> <font color=Magenta>0</font><font color=Cyan>,</font> <font color=Magenta>0</font><font color=Cyan>,</font> <font color=Magenta>1</font><font color=Cyan>,</font> x<font color=Cyan>)</font>
<a name="line-112"></a>  <font color=Red>|</font> otherwise <font color=Red>=</font> <font color=Cyan>(</font>b'<font color=Cyan>,</font>a'<font color=Blue><i>-</i></font>b'<font color=Cyan>*</font>q<font color=Cyan>,</font><font color=Blue><i>-</i></font>t'<font color=Cyan>,</font>t'<font color=Cyan>*</font>q<font color=Blue><i>-</i></font>s'<font color=Cyan>,</font>d<font color=Cyan>)</font> <font color=Green><u>where</u></font>
<a name="line-113"></a>    <font color=Cyan>(</font>a'<font color=Cyan>,</font>b'<font color=Cyan>,</font>s'<font color=Cyan>,</font>t'<font color=Cyan>,</font>d<font color=Cyan>)</font> <font color=Red>=</font> extended_euclid y r
<a name="line-114"></a>    <font color=Cyan>(</font>q<font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> divmod x y
<a name="line-115"></a>
<a name="line-116"></a><a name="euclid_inverse"></a><font color=Blue><i>-- | Find the inverse of a unit in a Euclidean domain. If the given</i></font>
<a name="line-117"></a><font color=Blue><i>-- element is not a unit, return 'Nothing'.</i></font>
<a name="line-118"></a><font color=Blue>euclid_inverse</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> Maybe a
<a name="line-119"></a><font color=Blue>euclid_inverse</font> x
<a name="line-120"></a>  <font color=Red>|</font> x <font color=Cyan>==</font> <font color=Magenta>0</font>    <font color=Red>=</font> Nothing
<a name="line-121"></a>  <font color=Red>|</font> r <font color=Cyan>==</font> <font color=Magenta>0</font>    <font color=Red>=</font> Just q
<a name="line-122"></a>  <font color=Red>|</font> otherwise <font color=Red>=</font> Nothing
<a name="line-123"></a>  <font color=Green><u>where</u></font>
<a name="line-124"></a>    <font color=Cyan>(</font>q<font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> divmod <font color=Magenta>1</font> x
<a name="line-125"></a>
<a name="line-126"></a><a name="is_unit"></a><font color=Blue><i>-- | Determine whether an element of a Euclidean domain is a unit.</i></font>
<a name="line-127"></a><font color=Blue>is_unit</font> <font color=Red>::</font> <font color=Cyan>(</font>EuclideanDomain a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> Bool
<a name="line-128"></a><font color=Blue>is_unit</font> <font color=Red>=</font> isJust <font color=Cyan>.</font> euclid_inverse
<a name="line-129"></a>
<a name="line-130"></a><a name="inv_mod"></a><font color=Blue><i>-- | Compute the inverse of /a/ in /R/\/(p), where /R/ is a Euclidean</i></font>
<a name="line-131"></a><font color=Blue><i>-- domain. Note: this works whenever /a/ and /p/ are relatively</i></font>
<a name="line-132"></a><font color=Blue><i>-- prime. If /a/ and /p/ are not relatively prime, return 'Nothing'.</i></font>
<a name="line-133"></a><font color=Blue>inv_mod</font> <font color=Red>::</font> EuclideanDomain a <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> Maybe a
<a name="line-134"></a><font color=Blue>inv_mod</font> p a <font color=Red>=</font> <font color=Green><u>case</u></font> euclid_inverse d <font color=Green><u>of</u></font>
<a name="line-135"></a>  Just d' <font color=Red>-&gt;</font> <font color=Green><u>let</u></font> <font color=Cyan>(</font>q<font color=Cyan>,</font>r<font color=Cyan>)</font> <font color=Red>=</font> <font color=Cyan>(</font>b<font color=Cyan>*</font>d'<font color=Cyan>)</font> <font color=Cyan>`divmod`</font> p <font color=Green><u>in</u></font> Just r
<a name="line-136"></a>  Nothing <font color=Red>-&gt;</font> Nothing
<a name="line-137"></a>  <font color=Green><u>where</u></font>
<a name="line-138"></a>    <font color=Cyan>(</font>b<font color=Cyan>,</font><font color=Green><u>_</u></font><font color=Cyan>,</font><font color=Green><u>_</u></font><font color=Cyan>,</font><font color=Green><u>_</u></font><font color=Cyan>,</font>d<font color=Cyan>)</font> <font color=Red>=</font> extended_euclid a p
<a name="line-139"></a>
<a name="line-140"></a><font color=Blue><i>-- ----------------------------------------------------------------------</i></font>
<a name="line-141"></a><font color=Blue><i>-- * Auxiliary functions</i></font>
<a name="line-142"></a>
<a name="line-143"></a><a name="rounddiv"></a><font color=Blue><i>-- | For /y/ &#8800; 0, find the integer /q/ closest to /x/ \/ /y/. This</i></font>
<a name="line-144"></a><font color=Blue><i>-- works regardless of whether /x/ and\/or /y/ are positive or</i></font>
<a name="line-145"></a><font color=Blue><i>-- negative.  The distance /q/ &#8722; /x/ \/ /y/ is guaranteed to be in</i></font>
<a name="line-146"></a><font color=Blue><i>-- (-1\/2, 1\/2].</i></font>
<a name="line-147"></a><font color=Blue>rounddiv</font> <font color=Red>::</font> <font color=Cyan>(</font>Integral a<font color=Cyan>)</font> <font color=Red>=&gt;</font> a <font color=Red>-&gt;</font> a <font color=Red>-&gt;</font> a
<a name="line-148"></a><font color=Blue>rounddiv</font> x y <font color=Red>=</font> 
<a name="line-149"></a>  <font color=Blue><i>-- Note: the use of "quot" and "div" is crucial for the signs to</i></font>
<a name="line-150"></a>  <font color=Blue><i>-- work out correctly.</i></font>
<a name="line-151"></a>  <font color=Cyan>(</font>x <font color=Cyan>+</font> y <font color=Cyan>`quot`</font> <font color=Magenta>2</font><font color=Cyan>)</font> <font color=Cyan>`div`</font> y
<a name="line-152"></a>
<a name="line-153"></a><font color=Green><u>infixl</u></font> <font color=Magenta>7</font> <font color=Cyan>`rounddiv`</font>
</pre>
</body>
</html>