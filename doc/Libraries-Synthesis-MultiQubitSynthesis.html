<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Libraries.Synthesis.MultiQubitSynthesis</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Libraries-Synthesis-MultiQubitSynthesis.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">The Quipper System</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Libraries.Synthesis.MultiQubitSynthesis</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Residues
</a></li><li><a href="#g:2">One- and two-level operators
</a><ul><li><a href="#g:3">Symbolic representation
</a></li><li><a href="#g:4">Constructors for two-level matrices
</a></li></ul></li><li><a href="#g:5">Auxiliary list functions
</a></li><li><a href="#g:6">Functions on &#8484;&#91;&#969;&#93;
</a></li><li><a href="#g:7">Functions on residues
</a></li><li><a href="#g:8">Exact synthesis
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides functions for the representation and exact
 synthesis of multi-qubit Clifford+<em>T</em> operators. 
</p><p>The multi-qubit Clifford+<em>T</em> exact synthesis algorithm is described
 in the paper:
</p><ul><li> Brett Giles, Peter Selinger. Exact synthesis of multiqubit Clifford+T
 circuits. <em>Physical Review A</em> 87, 032332 (7 pages), 2013. Available
 from <a href="http://arxiv.org/abs/1212.0506">http://arxiv.org/abs/1212.0506</a>.
</li></ul><p>It generalizes the single-qubit exact synthesis algorithm of
 Kliuchnikov, Maslov, and Mosca.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span>  <a href="#t:Residue">Residue</a> a b | a -&gt; b <span class="keyword">where</span><ul class="subs"><li><a href="#v:residue">residue</a> :: a -&gt; b</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Index">Index</a> = <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:TwoLevel">TwoLevel</a> <ul class="subs"><li>= <a href="#v:TL_X">TL_X</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>  </li><li>| <a href="#v:TL_H">TL_H</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>  </li><li>| <a href="#v:TL_T">TL_T</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>  </li><li>| <a href="#v:TL_omega">TL_omega</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>  </li></ul></li><li class="src short"><a href="#v:invert_twolevel">invert_twolevel</a> :: <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></li><li class="src short"><a href="#v:invert_twolevels">invert_twolevels</a> :: &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;</li><li class="src short"><a href="#v:twolevel_matrix">twolevel_matrix</a> :: (<a href="Libraries-Synthesis-Ring.html#t:Ring">Ring</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; (a, a) -&gt; (a, a) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a</li><li class="src short"><a href="#v:onelevel_matrix">onelevel_matrix</a> :: (<a href="Libraries-Synthesis-Ring.html#t:Ring">Ring</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; a -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a</li><li class="src short"><a href="#v:matrix_of_twolevel">matrix_of_twolevel</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ComplexRing">ComplexRing</a> a, <a href="Libraries-Synthesis-Ring.html#t:RootHalfRing">RootHalfRing</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a</li><li class="src short"><a href="#v:matrix_of_twolevels">matrix_of_twolevels</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ComplexRing">ComplexRing</a> a, <a href="Libraries-Synthesis-Ring.html#t:RootHalfRing">RootHalfRing</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a</li><li class="src short"><a href="#v:list_insert">list_insert</a> ::  <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; a -&gt; &#91;a&#93; -&gt; &#91;a&#93;</li><li class="src short"><a href="#v:transform_at">transform_at</a> ::  (a -&gt; a) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;a&#93; -&gt; &#91;a&#93;</li><li class="src short"><a href="#v:transform_at2">transform_at2</a> ::  ((a, a) -&gt; (a, a)) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;a&#93; -&gt; &#91;a&#93;</li><li class="src short"><a href="#v:list_pairs">list_pairs</a> ::  &#91;a&#93; -&gt; (&#91;(a, a)&#93;, <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)</li><li class="src short"><a href="#v:log_omega">log_omega</a> :: <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:omega_power">omega_power</a> :: <a href="Libraries-Synthesis-Ring.html#t:OmegaRing">OmegaRing</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; a -&gt; a</li><li class="src short"><a href="#v:reduce_ZOmega">reduce_ZOmega</a> :: <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a> -&gt; <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></li><li class="src short"><a href="#v:opX_zomega">opX_zomega</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>) -&gt; (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)</li><li class="src short"><a href="#v:opH_zomega">opH_zomega</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>) -&gt; (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)</li><li class="src short"><a href="#v:apply_twolevel_zomega">apply_twolevel_zomega</a> :: <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93;</li><li class="src short"><a href="#v:apply_twolevels_zomega">apply_twolevels_zomega</a> :: &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93;</li><li class="src short"><span class="keyword">data</span>  <a href="#t:ResidueType">ResidueType</a> <ul class="subs"><li>= <a href="#v:RT_0000">RT_0000</a>  </li><li>| <a href="#v:RT_0001">RT_0001</a>  </li><li>| <a href="#v:RT_1010">RT_1010</a>  </li></ul></li><li class="src short"><a href="#v:residue_type">residue_type</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a></li><li class="src short"><a href="#v:residue_shift">residue_shift</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:residue_type_shift">residue_type_shift</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; (<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a>, <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a>)</li><li class="src short"><a href="#v:residue_offset">residue_offset</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:reducible">reducible</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:row_step">row_step</a> :: ((<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>, <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>), (<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>, <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)) -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;</li><li class="src short"><a href="#v:reduce_column">reduce_column</a> :: <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n =&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n <a href="Libraries-Synthesis-Matrix.html#t:One">One</a> <a href="Libraries-Synthesis-Ring.html#t:DOmega">DOmega</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;</li><li class="src short"><a href="#v:synthesis_nqubit">synthesis_nqubit</a> :: <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n =&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n <a href="Libraries-Synthesis-Ring.html#t:DOmega">DOmega</a> -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;</li></ul></div><div id="interface"><h1 id="g:1">Residues
</h1><div class="top"><p class="src"><span class="keyword">class</span>  <a name="t:Residue" class="def">Residue</a> a b | a -&gt; b <span class="keyword">where</span><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-33" class="link">Source</a></p><div class="doc"><p>A type class for things that have residues. In a typical
 instance, <em>a</em> is a ring whose elements are expressed with
 coefficients in &#8484;, and <em>b</em> is a corresponding ring whose elements
 are expressed with coefficients in &#8484;<sub>2</sub>.
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:residue" class="def">residue</a> :: a -&gt; b<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-33" class="link">Source</a></p><div class="doc"><p>Return the residue of something.
</p></div></div><div class="subs instances"><p id="control.i:Residue" class="caption collapser" onclick="toggleSection('i:Residue')">Instances</p><div id="section.i:Residue" class="show"><table><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Prelude.html#t:Integer">Integer</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> () ()</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> &#91;a&#93; &#91;b&#93;</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (<a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> a) (<a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (<a href="Libraries-Synthesis-Ring.html#t:Cplx">Cplx</a> a) (<a href="Libraries-Synthesis-Ring.html#t:Cplx">Cplx</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (<a href="Libraries-Synthesis-Ring.html#t:RootTwo">RootTwo</a> a) (<a href="Libraries-Synthesis-Ring.html#t:RootTwo">RootTwo</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a a', <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> b b') =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (a, b) (a', b')</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (<a href="Libraries-Synthesis-Matrix.html#t:Vector">Vector</a> n a) (<a href="Libraries-Synthesis-Matrix.html#t:Vector">Vector</a> n b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> a b =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Residue">Residue</a> (<a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> m n a) (<a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> m n b)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">One- and two-level operators
</h1><h2 id="g:3">Symbolic representation
</h2><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Index" class="def">Index</a> = <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-71" class="link">Source</a></p><div class="doc"><p>An index for a row or column of a matrix.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:TwoLevel" class="def">TwoLevel</a>  <a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-82" class="link">Source</a></p><div class="doc"><p>Symbolic representation of one- and two-level operators. Note
 that the power <em>k</em> in the <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#v:TL_T">TL_T</a></code> and <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#v:TL_omega">TL_omega</a></code> constructors can be
 positive or negative, and should be regarded modulo 8.
</p><p>Note: when we use a list of <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operators to express a
 sequence of operators, the operators are meant to be applied
 right-to-left, i.e., as in the mathematical notation for matrix
 multiplication. This is the opposite of the quantum circuit
 notation.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:TL_X" class="def">TL_X</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a></td><td class="doc"><p><em>X</em><sub><em>i</em>,<em>j</em></sub>
</p></td></tr><tr><td class="src"><a name="v:TL_H" class="def">TL_H</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a></td><td class="doc"><p><em>H</em><sub><em>i</em>,<em>j</em></sub>
</p></td></tr><tr><td class="src"><a name="v:TL_T" class="def">TL_T</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a></td><td class="doc"><p>(<em>T</em><sub><em>i</em>,<em>j</em></sub>)<sup><em>k</em></sup>
</p></td></tr><tr><td class="src"><a name="v:TL_omega" class="def">TL_omega</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a></td><td class="doc"><p>(&#969;<sub><em>i</em></sub>)<sup><em>k</em></sup>
</p></td></tr></table></div><div class="subs instances"><p id="control.i:TwoLevel" class="caption collapser" onclick="toggleSection('i:TwoLevel')">Instances</p><div id="section.i:TwoLevel" class="show"><table><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Text-Show.html#t:Show">Show</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-CliffordT.html#t:ToGates">ToGates</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-LaTeX.html#t:ShowLaTeX">ShowLaTeX</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Libraries-Synthesis-LaTeX.html#t:ShowLaTeX">ShowLaTeX</a> &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:invert_twolevel" class="def">invert_twolevel</a> :: <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-90" class="link">Source</a></p><div class="doc"><p>Invert a <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operator.
</p></div></div><div class="top"><p class="src"><a name="v:invert_twolevels" class="def">invert_twolevels</a> :: &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-97" class="link">Source</a></p><div class="doc"><p>Invert a list of <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operators.
</p></div></div><h2 id="g:4">Constructors for two-level matrices
</h2><div class="top"><p class="src"><a name="v:twolevel_matrix" class="def">twolevel_matrix</a> :: (<a href="Libraries-Synthesis-Ring.html#t:Ring">Ring</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; (a, a) -&gt; (a, a) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-104" class="link">Source</a></p><div class="doc"><p>Construct a two-level matrix with the given entries.
</p></div></div><div class="top"><p class="src"><a name="v:onelevel_matrix" class="def">onelevel_matrix</a> :: (<a href="Libraries-Synthesis-Ring.html#t:Ring">Ring</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; a -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-115" class="link">Source</a></p><div class="doc"><p>Construct a one-level matrix with the given entry.
</p></div></div><div class="top"><p class="src"><a name="v:matrix_of_twolevel" class="def">matrix_of_twolevel</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ComplexRing">ComplexRing</a> a, <a href="Libraries-Synthesis-Ring.html#t:RootHalfRing">RootHalfRing</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-123" class="link">Source</a></p><div class="doc"><p>Convert a symbolic one- or two-level operator into a matrix.
</p></div></div><div class="top"><p class="src"><a name="v:matrix_of_twolevels" class="def">matrix_of_twolevels</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ComplexRing">ComplexRing</a> a, <a href="Libraries-Synthesis-Ring.html#t:RootHalfRing">RootHalfRing</a> a, <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n) =&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n a<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-133" class="link">Source</a></p><div class="doc"><p>Convert a list of symbolic one- or two-level operators into a
 matrix. Note that the operators are to be applied right-to-left,
 exactly as in mathematical notation.
</p></div></div><h1 id="g:5">Auxiliary list functions
</h1><div class="top"><p class="src"><a name="v:list_insert" class="def">list_insert</a> ::  <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; a -&gt; &#91;a&#93; -&gt; &#91;a&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-140" class="link">Source</a></p><div class="doc"><p>Replace the <em>i</em>th element of a list by <em>x</em>.
</p></div></div><div class="top"><p class="src"><a name="v:transform_at" class="def">transform_at</a> ::  (a -&gt; a) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;a&#93; -&gt; &#91;a&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-146" class="link">Source</a></p><div class="doc"><p>Apply a unary operator to element <em>i</em> of a list.
</p></div></div><div class="top"><p class="src"><a name="v:transform_at2" class="def">transform_at2</a> ::  ((a, a) -&gt; (a, a)) -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;a&#93; -&gt; &#91;a&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-153" class="link">Source</a></p><div class="doc"><p>Apply a binary operator to elements <em>i</em> and <em>j</em> of a list.
</p></div></div><div class="top"><p class="src"><a name="v:list_pairs" class="def">list_pairs</a> ::  &#91;a&#93; -&gt; (&#91;(a, a)&#93;, <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> a)<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-161" class="link">Source</a></p><div class="doc"><p>Split a list into pairs. Return a list of pairs, and a final
 element if the length of the list was odd.
</p></div></div><h1 id="g:6">Functions on &#8484;&#91;&#969;&#93;
</h1><div class="top"><p class="src"><a name="v:log_omega" class="def">log_omega</a> :: <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-171" class="link">Source</a></p><div class="doc"><p>Given an element of the form &#969;<sup><em>m</em></sup>, return <em>m</em> &#8712; {0,&#8230;,7}, or
 <code><a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Maybe.html#v:Nothing">Nothing</a></code> if not of that form.
</p></div></div><div class="top"><p class="src"><a name="v:omega_power" class="def">omega_power</a> :: <a href="Libraries-Synthesis-Ring.html#t:OmegaRing">OmegaRing</a> a =&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; a -&gt; a<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-183" class="link">Source</a></p><div class="doc"><p>Multiply a scalar by &#969;<sup><em>n</em></sup>.
</p></div></div><div class="top"><p class="src"><a name="v:reduce_ZOmega" class="def">reduce_ZOmega</a> :: <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a> -&gt; <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-188" class="link">Source</a></p><div class="doc"><p>Divide an element of <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code> by &#8730;2, or throw an error if it is
 not divisible.
</p></div></div><div class="top"><p class="src"><a name="v:opX_zomega" class="def">opX_zomega</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>) -&gt; (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-199" class="link">Source</a></p><div class="doc"><p>Apply the <em>X</em> operator to a 2-dimensional vector over <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:opH_zomega" class="def">opH_zomega</a> :: (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>) -&gt; (<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-205" class="link">Source</a></p><div class="doc"><p>Apply the <em>H</em> operator to a 2-dimensional vector over
 <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>. This throws an error if the result is not well-defined
 over <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:apply_twolevel_zomega" class="def">apply_twolevel_zomega</a> :: <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a> -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-211" class="link">Source</a></p><div class="doc"><p>Apply a <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operator to a <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>-vector, represented as
 a list. Throws an error if any operation produces a scalar that is
 not in <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:apply_twolevels_zomega" class="def">apply_twolevels_zomega</a> :: &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93; -&gt; &#91;<a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-220" class="link">Source</a></p><div class="doc"><p>Apply a list of <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operators to a <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>-vector,
 represented as a list. Throws an error if any operation produces a
 scalar that is not in <code><a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a></code>.
</p></div></div><h1 id="g:7">Functions on residues
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:ResidueType" class="def">ResidueType</a>  <a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-229" class="link">Source</a></p><div class="doc"><p>The <em>residue type</em> of <em>t</em> &#8712; &#8484;&#91;&#969;&#93; is the residue of <em>t</em><sup>&#8224;</sup><em>t</em>.
 It is 0000, 0001, or 1010.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:RT_0000" class="def">RT_0000</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:RT_0001" class="def">RT_0001</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:RT_1010" class="def">RT_1010</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ResidueType" class="caption collapser" onclick="toggleSection('i:ResidueType')">Instances</p><div id="section.i:ResidueType" class="show"><table><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Ord.html#t:Ord">Ord</a> <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:residue_type" class="def">residue_type</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-233" class="link">Source</a></p><div class="doc"><p>Return the residue's <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:residue_shift" class="def">residue_shift</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-250" class="link">Source</a></p><div class="doc"><p>Return the residue's <em>shift</em>.
</p><p>The shift is defined so that: 
</p><ul><li> 0001, 1110, 0011 have shift 0,
</li><li> 0010, 1101, 0110 have shift 1,
</li><li> 0100, 1011, 1100 have shift 2, and
</li><li> 1000, 0111, 1001 have shift 3.
</li></ul><p>Residues of type <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#v:RT_0000">RT_0000</a></code> have shift 0.
</p></div></div><div class="top"><p class="src"><a name="v:residue_type_shift" class="def">residue_type_shift</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; (<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a>, <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a>)<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-255" class="link">Source</a></p><div class="doc"><p>Return the residue's <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:ResidueType">ResidueType</a></code> and the shift.
</p></div></div><div class="top"><p class="src"><a name="v:residue_offset" class="def">residue_offset</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Int.html#t:Int">Int</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-277" class="link">Source</a></p><div class="doc"><p>Given two irreducible residues <em>a</em> and <em>b</em> of the same type, find
 an index <em>m</em> such that <em>a</em> + &#969;<sup><em>m</em></sup><em>b</em> = 0000. If no such index
 exists, find an index <em>m</em> such that <em>a</em> + &#969;<sup><em>m</em></sup><em>b</em> = 1111.
</p></div></div><div class="top"><p class="src"><a name="v:reducible" class="def">reducible</a> :: <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Bool.html#t:Bool">Bool</a><a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-282" class="link">Source</a></p><div class="doc"><p>Check whether a residue is reducible. A residue <em>r</em> is called <em>reducible</em>
 if it is of the form <em>r</em> = &#8730;2 &#8901; <em>r</em>', i.e., <em>r</em> &#8712; {0000, 0101, 1010, 1111}.
</p></div></div><h1 id="g:8">Exact synthesis
</h1><div class="top"><p class="src"><a name="v:row_step" class="def">row_step</a> :: ((<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>, <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>), (<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a>, <a href="Libraries-Synthesis-Ring.html#t:Omega">Omega</a> <a href="Libraries-Synthesis-Ring.html#t:Z2">Z2</a>, <a href="Libraries-Synthesis-Ring.html#t:ZOmega">ZOmega</a>)) -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-293" class="link">Source</a></p><div class="doc"><p>Perform a single row operation as in Lemma 4, applied to rows <em>i</em>
 and <em>j</em>.  The entries at rows <em>i</em> and <em>j</em> are <em>x</em> and <em>y</em>,
 respectively, with respective residues <em>a</em> and <em>b</em>. A precondition
 is that <em>x</em> and <em>y</em> are of the same residue type. Returns a list of
 two-level operations that decreases the denominator exponent.
</p></div></div><div class="top"><p class="src"><a name="v:reduce_column" class="def">reduce_column</a> :: <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n =&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n <a href="Libraries-Synthesis-Matrix.html#t:One">One</a> <a href="Libraries-Synthesis-Ring.html#t:DOmega">DOmega</a> -&gt; <a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:Index">Index</a> -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-309" class="link">Source</a></p><div class="doc"><p>Row reduction: Given a unit column vector <em>v</em>, generate a
 sequence of two-level operators that reduces the <em>i</em>th standard
 basis vector <em>e</em><sub><em>i</em></sub> to <em>v</em>. Any rows that are already 0 in
 both vectors are guaranteed not to be touched.
</p></div></div><div class="top"><p class="src"><a name="v:synthesis_nqubit" class="def">synthesis_nqubit</a> :: <a href="Libraries-Synthesis-Matrix.html#t:Nat">Nat</a> n =&gt; <a href="Libraries-Synthesis-Matrix.html#t:Matrix">Matrix</a> n n <a href="Libraries-Synthesis-Ring.html#t:DOmega">DOmega</a> -&gt; &#91;<a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a>&#93;<a href="src/Libraries/Synthesis/MultiQubitSynthesis.html#line-348" class="link">Source</a></p><div class="doc"><p>Input an exact <em>n</em>&#215;<em>n</em> unitary operator with coefficients in
 <b>D</b>&#91;&#969;&#93;, and output an equivalent sequence of two-level
 operators.  This is the algorithm from the Giles-Selinger paper. It
 has superexponential complexity.
</p><p>Note: the list of <code><a href="Libraries-Synthesis-MultiQubitSynthesis.html#t:TwoLevel">TwoLevel</a></code> operators will be returned in
 right-to-left order, i.e., as in the mathematical notation for
 matrix multiplication. This is the opposite of the quantum circuit
 notation.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.11.0</p></div></body></html>
